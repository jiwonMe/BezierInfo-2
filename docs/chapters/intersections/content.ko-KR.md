# 교차점

베지에 곡선으로 하고 싶은 몇 가지를 더 살펴봅시다. 바운딩 박스를 작동시키는 방법을 파악한 직후, 사람들은 (회전 기반) 최소 바운딩 박스가 타이트하더라도 진정한 충돌 감지를 수행하기에는 충분하지 않다는 문제에 거의 즉시 부딪칩니다. 충돌이 *있을 수 있음*을 확인하기 위한 좋은 첫 번째 단계이지만(바운딩 박스 겹침이 없으면 충돌이 있을 수 없음), 실제 충돌 감지를 수행하려면 실제 곡선에 교차점이 있는지 여부를 알아야 합니다.

곡선/곡선 교차 검사에 도달하기까지 약간의 여정이므로 단계별로 수행하겠습니다. 먼저 선-선 교차 검사기를 구현하여 간단하게 시작해봅시다. 전통적인 미적분 방식(두 선에 대한 함수를 결정한 다음 동등하게 만들고 두 미지수를 푸는 것)으로 해결할 수 있지만, 선형 대수학이 실제로 더 나은 해결책을 제공합니다.

### 선-선 교차점

각각 두 개의 좌표를 가진 두 개의 선분, 세그먼트 A-B와 C-D가 있다면, 이 [top coder](https://www.topcoder.com/community/competitive-programming/tutorials/geometry-concepts-line-intersection-and-its-applications/) 기사에 설명된 절차를 사용하여 선형 대수학으로 이 세그먼트가 간격인 선의 교차점을 찾을 수 있습니다. 물론 교차점이 선분이 놓인 선에만 있는 것이 아니라 실제로 선분 자체에 있는지 확인해야 합니다. 따라서 교차점을 찾은 후 원래 선분의 경계 내에 있는지 확인해야 합니다.

다음 그래픽은 이 교차 감지를 구현하여 세그먼트가 놓인 선의 교차점(따라서 가상 교차점)에 빨간 점을 표시하고, 두 세그먼트에 모두 있는 교차점(실제 교차점)에 녹색 점을 표시합니다.

<graphics-element title="선/선 교차점" src="./line-line.js"></graphics-element>

<div class="howtocode">

### 선-선 교차 구현

선-선 교차 검사 함수를 구현하는 방법을 살펴봅시다. 기본 사항은 위에 언급된 기사에서 다루지만, 때로는 8개의 개별 매개변수로 함수를 호출하고 싶지 않을 수 있으므로 더 많은 함수 시그니처가 필요합니다. 선에 대한 점 구조체를 사용할 수도 있습니다. 코딩해봅시다.

```
lli8 = function(x1,y1,x2,y2,x3,y3,x4,y4):
  var nx=(x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4),
      ny=(x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4),
      d=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);
  if d=0:
    return false
  return point(nx/d, ny/d)

lli4 = function(p1, p2, p3, p4):
  var x1 = p1.x, y1 = p1.y,
      x2 = p2.x, y2 = p2.y,
      x3 = p3.x, y3 = p3.y,
      x4 = p4.x, y4 = p4.y;
  return lli8(x1,y1,x2,y2,x3,y3,x4,y4)

lli = function(line1, line2):
  return lli4(line1.p1, line1.p2, line2.p1, line2.p2)
```

</div>

### 곡선-선 교차점은?

곡선/선 교차는 더 많은 작업이지만, 이를 수행하기 위해 사용해야 하는 기술은 이미 봤습니다. 먼저 선과 곡선을 함께 이동/회전하여 선이 x축과 일치하도록 합니다. 이렇게 하면 y 함수가 0인 지점에서 곡선이 선을 교차하도록 위치시킵니다. 이렇게 하면 곡선과 선 사이의 교차점을 찾는 문제가 이제 극값 찾기 섹션에서 이미 다룬 것처럼 이동/회전된 곡선에서 근 찾기를 수행하는 문제가 됩니다.

<div class="figure">
<graphics-element title="2차 곡선/선 교차점" src="./curve-line.js" data-type="quadratic"></graphics-element>
<graphics-element title="3차 곡선/선 교차점" src="./curve-line.js" data-type="cubic"></graphics-element>
</div>

그러나 곡선/곡선 교차는 더 복잡합니다. 정렬할 직선이 없으므로 곡선 중 하나를 단순히 정렬하고 간단한 절차로 남길 수 없습니다. 대신 이전에 만난 두 가지 기술을 적용해야 합니다. 드 카스텔죠 알고리즘과 곡선 분할입니다.
