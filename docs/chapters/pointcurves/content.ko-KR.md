# 세 점으로 곡선 만들기

이전 섹션을 고려하면, 그 지식을 사용하여 점 몇 개를 배치하고 컴퓨터가 나머지를 하도록 하여 곡선을 그냥 "만들" 수 있는지 궁금할 수 있습니다. 답은: 바로 그것이 우리가 이제 할 수 있는 것입니다!

2차 곡선의 경우 상황이 꽤 쉽습니다. 기술적으로 ABC 좌표를 계산하는 데 사용되는 비율 함수를 계산하기 위해 `t` 값이 필요하지만, 시작점과 `B` 점 사이의 거리와 `B`와 끝점 사이의 거리를 비율로 취급하여 다음을 사용하여 근사할 수 있습니다.

\[
  \left \{ \begin{aligned}
    d_1 &= ||\textit{Start} - B||\\
    d_2 &= ||\textit{End} - B||\\
    t &= \frac{d_1}{d_1+d_2}
  \end{aligned} \right .
\]

이 코드가 제자리에 있으면 세 점에서 2차 곡선을 만드는 것은 문자 그대로 ABC 값을 계산하고 `A`를 곡선의 제어점으로 사용하는 것입니다.

<graphics-element title="2차 베지에 곡선 맞추기" src="./quadratic.js"></graphics-element>

3차 곡선의 경우 조금 더 작업을 해야 하지만 정말 조금만 더 하면 됩니다. 먼저 세 점을 통과하는 괜찮은 곡선이 원호를 근사해야 한다고 가정하겠습니다. 이를 위해서는 먼저 세 점에 원을 맞추는 방법을 알아야 합니다. 원의 두 점 사이의 선을 [현](https://en.wikipedia.org/wiki/Chord_%28geometry%29)이라고 부른다는 것을 기억할 수 있습니다(배운 적이 있다면!). 현의 한 가지 속성은 현의 중심에서 그 현에 수직인 선이 원의 중심을 통과한다는 것입니다.

즉, 원 위에 세 점이 있으면 세 개의 (다른) 현이 있고, 결과적으로 그 현에서 원의 중심을 통과하는 세 개의 (다른) 선이 있습니다. 그 선 중 두 개를 찾으면 교차점이 원의 중심이 되고, 원의 반경은—정의에 의해!—중심에서 세 점 중 아무 점까지의 거리가 됩니다.

<graphics-element title="세 점을 통과하는 원 찾기" src="./circle.js"></graphics-element>

이것을 다루었으니, 이제 점 `B`에 대한 접선도 알게 됩니다. 원의 모든 점에 대한 접선은 그 점을 통과하는 선이며, 그 점에서 중심까지의 선에 수직이기 때문입니다. 이제 새로운 3차 곡선 헐을 구성할 수 있도록 그 접선에 적절한 점 `e1`과 `e2`를 표시하는 것만 남았습니다. 2차 곡선에 대해 했던 것과 같은 접근 방식을 사용하여 합리적인 `t` 값을 자동으로 결정한 다음, `e1`과 `e2` 좌표는 선형 보간에 대한 표준 드 카스텔죠 규칙을 따라야 합니다.

\[
  \left \{ \begin{aligned}
    e_1 &= B + t \cdot d\\
    e_2 &= B - (1-t) \cdot d
  \end{aligned} \right .
\]

여기서 `d`는 `e1`에서 `e2`까지 선분의 총 길이입니다. 그렇다면 얼마나 길게 만들까요? 다시 말하지만 취할 수 있는 모든 종류의 접근 방식이 있으며, 간단하지만 효과적인 것은 그 세그먼트의 길이를 "기준선 길이의 3분의 1"로 설정하는 것입니다. 이렇게 하면 `e1`과 `e2`가 항상 "선형 곡선" 거리만큼 떨어져 있도록 강제합니다. 즉, 세 점을 선 위에 놓으면 실제로 선처럼 _보일_ 것입니다. 멋지네요! 마지막으로 해야 할 일은 루프가 있는 괴상한 곡선을 만들지 않도록 `B`가 기준선의 어느 쪽에 위치하는지에 따라 `d`의 부호를 뒤집는 것입니다. 이를 위해 [atan2](https://en.wikipedia.org/wiki/Atan2) 함수를 사용할 수 있습니다.

\[
  \phi = \left ( atan2(E_y-S_y, E_x-S_x) - atan2(B_y-S_y, B_x-S_x) + 2 \pi \right ) \textit{ mod } 2 \pi
\]

이 각도 φ는 `B`가 기준선 "위"에 있으면(시작이 왼쪽에 있고 끝이 오른쪽에 있도록 세 점을 모두 회전) 0과 π 사이에 있으므로, 값 `d`에 올바른 부호를 사용하고 있는지 확인하기 위해 상대적으로 간단한 검사를 사용할 수 있습니다.

\[
  d = \left \{ \begin{aligned}
     d & \textit{ if } 0 \leq \phi \leq \pi \\
    -d & \textit{ if } \phi < 0 \lor \phi > \pi
  \end{aligned} \right .
\]

이 접근 방식의 결과는 다음과 같습니다.

<graphics-element title="세 점이 주어졌을 때 3차 e₁과 e₂ 찾기" src="./circle.js" data-show-curve="true"></graphics-element>

원호를 사용하여 괜찮은 `e1`과 `e2` 항을 찾고 있지만, 3차 곡선으로 원호를 완벽하게 만들려는 것이 _아니라는_ 점을 기억하는 것이 중요합니다(그것은 좋은데, 왜냐하면 할 수 없기 때문입니다. [나중에 더 자세히](#arcapproximation)). 우리는 새로운 3차 곡선을 구성할 수 있도록 합리적인 `e1`과 `e2` 점을 찾으려는 것일 _뿐_입니다... 그래서 이제 그것들이 있으니: 그것이 어떤 종류의 3차 곡선을 제공하는지 봅시다.

<graphics-element title="3차 베지에 곡선 맞추기" src="./cubic.js"></graphics-element>

완벽하게 쓸 만해 보입니다!

물론 한 단계 더 나아갈 수 있습니다. 곡선을 그냥 "만들" 수만 있는 것이 아니라, 곡선 위의 점을 끌어다니면서 시작과 끝은 고정한 채 곡선을 재구성하여 점토처럼 형태를 성형하는 "성형" 곡선에 필요한 (거의!) 모든 도구를 사용할 수 있습니다. 다음 섹션에서 그렇게 하는 데 필요한 마지막 도구를 보고, 그 다음 섹션에서 곡선 성형 구현을 살펴보겠습니다. 계속 읽어보세요!
